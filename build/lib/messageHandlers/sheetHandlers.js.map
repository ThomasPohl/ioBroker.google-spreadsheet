{
  "version": 3,
  "sources": ["../../../src/lib/messageHandlers/sheetHandlers.ts"],
  "sourcesContent": ["import type { SpreadsheetUtils } from '../google';\n\n/**\n * Handles appending data to a spreadsheet sheet.\n *\n * @param spreadsheet The SpreadsheetUtils instance to use.\n * @param log The logger instance for logging.\n * @param message The message containing parameters for the operation.\n */\nexport function handleAppend(\n    spreadsheet: SpreadsheetUtils,\n    log: ioBroker.Logger,\n    message: Record<string, any>,\n): Promise<void> {\n    return new Promise<void>((resolve, reject) => {\n        const messageData: Record<string, any> = message.message as Record<string, any>;\n        let sheet = messageData.sheet;\n        let values = messageData.values;\n        const alias = messageData.alias;\n        if (!sheet && messageData.sheetName) {\n            log.warn(\"Parameter 'sheetName' is deprecated, please use 'sheet' instead!\");\n            sheet = messageData.sheetName;\n        }\n        if (!values && messageData.data) {\n            log.warn(\"Parameter 'data' is deprecated, please use 'values' instead!\");\n            values = messageData.data;\n        }\n        if (!sheet || !values) {\n            log.error(\"Missing parameters for append: 'sheet' and/or 'values'\");\n            reject(new Error('Missing parameters for append'));\n            return;\n        }\n        spreadsheet\n            .append(sheet, values, alias)\n            .then(() => resolve())\n            .catch(error => reject(new Error(error)));\n    });\n}\n\n/**\n * Handles deleting rows in a spreadsheet sheet.\n *\n * @param spreadsheet The SpreadsheetUtils instance to use.\n * @param log The logger instance for logging.\n * @param message The message containing parameters for the operation.\n */\nexport function handleDeleteRows(\n    spreadsheet: SpreadsheetUtils,\n    log: ioBroker.Logger,\n    message: Record<string, any>,\n): Promise<void> {\n    return new Promise<void>((resolve, reject) => {\n        const messageData: Record<string, any> = message.message as Record<string, any>;\n        let sheet = messageData.sheet;\n        const start = messageData.start;\n        const end = messageData.end;\n        const alias = messageData.alias;\n        if (!sheet && messageData.sheetName) {\n            log.warn(\"Parameter 'sheetName' is deprecated, please use 'sheet' instead!\");\n            sheet = messageData.sheetName;\n        }\n        if (!sheet || typeof start !== 'number' || typeof end !== 'number') {\n            log.error(\"Missing parameters for deleteRows: 'sheet', 'start', 'end'\");\n            reject(new Error('Missing parameters for deleteRows'));\n            return;\n        }\n        spreadsheet\n            .deleteRows(sheet, start, end, alias)\n            .then(() => resolve())\n            .catch(error => reject(new Error(error)));\n    });\n}\n\n/**\n * Handles creating a new spreadsheet sheet.\n *\n * @param spreadsheet The SpreadsheetUtils instance\n * @param log The logger instance\n * @param message The message containing parameters\n */\nexport function handleCreateSheet(\n    spreadsheet: SpreadsheetUtils,\n    log: ioBroker.Logger,\n    message: Record<string, any>,\n): Promise<void> {\n    if (typeof message.message === 'string') {\n        log.warn('Deprecated call of createSheet with string as message. Please use an object with sheet!');\n        return spreadsheet.createSheet(message.message, null);\n    }\n    const messageData: Record<string, any> = message.message as Record<string, any>;\n    let sheet = messageData.sheet;\n    const alias = messageData.alias;\n    if (!sheet && messageData.sheetName) {\n        log.warn(\"Parameter 'sheetName' is deprecated, please use 'sheet' instead!\");\n        sheet = messageData.sheetName;\n    }\n    if (!sheet) {\n        log.error(\"Missing parameter for createSheet: 'sheet'\");\n        return Promise.reject(new Error('Missing parameters for createSheet'));\n    }\n    return spreadsheet.createSheet(sheet, alias);\n}\n\n/**\n * Handles deleting a spreadsheet sheet.\n *\n * @param spreadsheet The SpreadsheetUtils instance to use.\n * @param log The logger instance for logging.\n * @param message The message containing parameters for the operation.\n */\nexport function handleDeleteSheet(\n    spreadsheet: SpreadsheetUtils,\n    log: ioBroker.Logger,\n    message: Record<string, any>,\n): Promise<void> {\n    if (typeof message.message === 'string') {\n        log.warn('Deprecated call of deleteSheet with string as message. Please use an object with sheet!');\n        return spreadsheet.deleteSheet(message.message);\n    }\n    const messageData: Record<string, any> = message.message as Record<string, any>;\n    let sheet = messageData.sheet;\n    const alias = messageData.alias;\n    if (!sheet && messageData.sheetName) {\n        log.warn(\"Parameter 'sheetName' is deprecated, please use 'sheet' instead!\");\n        sheet = messageData.sheetName;\n    }\n    if (!sheet) {\n        log.error(\"Missing parameter for deleteSheet: 'sheet'\");\n        return Promise.reject(new Error('Missing parameters for deleteSheet'));\n    }\n    return spreadsheet.deleteSheet(sheet, alias);\n}\n\n/**\n * Handles deleting multiple spreadsheet sheets.\n *\n * @param spreadsheet The SpreadsheetUtils instance to use.\n * @param log The logger instance for logging.\n * @param message The message containing parameters for the operation.\n */\nexport function handleDeleteSheets(\n    spreadsheet: SpreadsheetUtils,\n    log: ioBroker.Logger,\n    message: Record<string, any>,\n): Promise<void> {\n    if (Array.isArray(message.message)) {\n        log.warn('Deprecated call of deleteSheets with array as message. Please use an object with sheets!');\n        return spreadsheet.deleteSheets(message.message as string[], null);\n    }\n    const messageData: Record<string, any> = message.message as Record<string, any>;\n    let sheets = messageData.sheets;\n    const alias = messageData.alias;\n    if (!sheets && messageData.sheetNames) {\n        log.warn(\"Parameter 'sheetNames' is deprecated, please use 'sheets' instead!\");\n        sheets = messageData.sheetNames;\n    }\n    if (!sheets) {\n        log.error(\"Missing parameter for deleteSheets: 'sheets'\");\n        return Promise.reject(new Error('Missing parameters for deleteSheets'));\n    }\n    return spreadsheet.deleteSheets(sheets, alias);\n}\n\n/**\n * Handles duplicating a spreadsheet sheet.\n *\n * @param spreadsheet The SpreadsheetUtils instance to use.\n * @param log The logger instance for logging.\n * @param message The message containing parameters for the operation.\n */\nexport function handleDuplicateSheet(\n    spreadsheet: SpreadsheetUtils,\n    log: ioBroker.Logger,\n    message: Record<string, any>,\n): Promise<void> {\n    const messageData: Record<string, any> = message.message as Record<string, any>;\n    const source = messageData.source;\n    const target = messageData.target;\n    const index = messageData.index;\n    const alias = messageData.alias;\n    if (!source || !target || typeof index !== 'number') {\n        log.error(\"Missing parameters for duplicateSheet: 'source', 'target', 'index'\");\n        return Promise.reject(new Error('Missing parameters for duplicateSheet'));\n    }\n    return spreadsheet.duplicateSheet(source, target, index, alias);\n}\n"],
  "mappings": "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",
  "names": []
}

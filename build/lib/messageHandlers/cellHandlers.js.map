{
  "version": 3,
  "sources": ["../../../src/lib/messageHandlers/cellHandlers.ts"],
  "sourcesContent": ["import type { SpreadsheetUtils } from '../google';\n\n/**\n * Handles writing to a single cell of a spreadsheet sheet.\n *\n * @param spreadsheet The SpreadsheetUtils instance to use.\n * @param log The logger instance for logging.\n * @param message The message containing parameters for the operation.\n */\nexport function handleWriteCell(\n    spreadsheet: SpreadsheetUtils,\n    log: ioBroker.Logger,\n    message: Record<string, any>,\n): Promise<void> {\n    const messageData: Record<string, any> = message.message as Record<string, any>;\n    let sheet = messageData.sheet;\n    const cell = messageData.cell;\n    let value = messageData.value;\n    const alias = messageData.alias;\n    if (!sheet && messageData.sheetName) {\n        log.warn(\"Parameter 'sheetName' is deprecated, please use 'sheet' instead!\");\n        sheet = messageData.sheetName;\n    }\n    if (!value && messageData.data) {\n        log.warn(\"Parameter 'data' is deprecated, please use 'value' instead!\");\n        value = messageData.data;\n    }\n    if (!sheet || !cell || typeof value === 'undefined') {\n        log.error(\"Missing parameters for writeCell: 'sheet', 'cell', 'value'\");\n        return Promise.reject(new Error('Missing parameters for writeCell'));\n    }\n    const cellPattern = new RegExp('^[A-Z]+[0-9]+$');\n    if (!cellPattern.test(cell)) {\n        log.error(`Invalid cell pattern ${cell}. Expected: A1`);\n        return Promise.reject(new Error(`Invalid cell pattern ${cell}. Expected: A1`));\n    }\n    return spreadsheet.writeCell(sheet, cell, value, alias);\n}\n\n/**\n * Handles writing to multiple cells of one or more spreadsheet sheets.\n *\n * @param spreadsheet The SpreadsheetUtils instance to use.\n * @param log The logger instance for logging.\n * @param message The message containing parameters for the operation.\n */\nexport function handleWriteCells(\n    spreadsheet: SpreadsheetUtils,\n    log: ioBroker.Logger,\n    message: Record<string, any>,\n): Promise<void> {\n    const messageData: Record<string, any> = message.message as Record<string, any>;\n    const cells = messageData.cells;\n    const alias = messageData.alias;\n    if (!cells) {\n        log.error(\"Missing parameter for writeCells: 'cells'\");\n        return Promise.reject(new Error('Missing parameters for writeCells'));\n    }\n    const cellPattern = new RegExp('^[A-Z]+[0-9]+$');\n    for (const cellObj of cells) {\n        if (!cellObj.sheet && cellObj.sheetName) {\n            log.warn(\"Parameter 'sheetName' in cells is deprecated, please use 'sheet' instead!\");\n            cellObj.sheet = cellObj.sheetName;\n        }\n        if (!cellObj.value && typeof cellObj.data !== 'undefined') {\n            log.warn(\"Parameter 'data' in cells is deprecated, please use 'value' instead!\");\n            cellObj.value = cellObj.data;\n        }\n        if (!cellObj.sheet || !cellObj.cell || typeof cellObj.value === 'undefined') {\n            log.error(\"Missing parameters for writeCells: 'sheet', 'cell', 'value' in cells\");\n            return Promise.reject(new Error('Missing parameters for writeCells'));\n        }\n        if (!cellPattern.test(cellObj.cell)) {\n            log.error(`Invalid cell pattern ${cellObj.cell}. Expected: A1`);\n            return Promise.reject(new Error(`Invalid cell pattern ${cellObj.cell}. Expected: A1`));\n        }\n    }\n    return spreadsheet.writeCells(cells, alias);\n}\n\n/**\n * Handles reading a single cell of a spreadsheet sheet.\n * Returns the value of the cell.\n *\n * @param spreadsheet The SpreadsheetUtils instance to use.\n * @param log The logger instance for logging.\n * @param message The message containing parameters for the operation.\n */\nexport function handleReadCell(\n    spreadsheet: SpreadsheetUtils,\n    log: ioBroker.Logger,\n    message: Record<string, any>,\n): Promise<any> {\n    const messageData: Record<string, any> = message.message as Record<string, any>;\n    let sheet = messageData.sheet;\n    const cell = messageData.cell;\n    const alias = messageData.alias;\n    if (!sheet && messageData.sheetName) {\n        log.warn(\"Parameter 'sheetName' is deprecated, please use 'sheet' instead!\");\n        sheet = messageData.sheetName;\n    }\n    if (!sheet || !cell) {\n        log.error(\"Missing parameters for readCell: 'sheet', 'cell'\");\n        return Promise.reject(new Error('Missing parameters for readCell'));\n    }\n    const cellPattern = new RegExp('^[A-Z]+[0-9]+$');\n    if (!cellPattern.test(cell)) {\n        log.error(`Invalid cell pattern ${cell}. Expected: A1`);\n        return Promise.reject(new Error(`Invalid cell pattern ${cell}. Expected: A1`));\n    }\n    return spreadsheet.readCell(sheet, cell, alias);\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASO,SAAS,gBACZ,aACA,KACA,SACa;AACb,QAAM,cAAmC,QAAQ;AACjD,MAAI,QAAQ,YAAY;AACxB,QAAM,OAAO,YAAY;AACzB,MAAI,QAAQ,YAAY;AACxB,QAAM,QAAQ,YAAY;AAC1B,MAAI,CAAC,SAAS,YAAY,WAAW;AACjC,QAAI,KAAK,kEAAkE;AAC3E,YAAQ,YAAY;AAAA,EACxB;AACA,MAAI,CAAC,SAAS,YAAY,MAAM;AAC5B,QAAI,KAAK,6DAA6D;AACtE,YAAQ,YAAY;AAAA,EACxB;AACA,MAAI,CAAC,SAAS,CAAC,QAAQ,OAAO,UAAU,aAAa;AACjD,QAAI,MAAM,4DAA4D;AACtE,WAAO,QAAQ,OAAO,IAAI,MAAM,kCAAkC,CAAC;AAAA,EACvE;AACA,QAAM,cAAc,IAAI,OAAO,gBAAgB;AAC/C,MAAI,CAAC,YAAY,KAAK,IAAI,GAAG;AACzB,QAAI,MAAM,wBAAwB,IAAI,gBAAgB;AACtD,WAAO,QAAQ,OAAO,IAAI,MAAM,wBAAwB,IAAI,gBAAgB,CAAC;AAAA,EACjF;AACA,SAAO,YAAY,UAAU,OAAO,MAAM,OAAO,KAAK;AAC1D;AASO,SAAS,iBACZ,aACA,KACA,SACa;AACb,QAAM,cAAmC,QAAQ;AACjD,QAAM,QAAQ,YAAY;AAC1B,QAAM,QAAQ,YAAY;AAC1B,MAAI,CAAC,OAAO;AACR,QAAI,MAAM,2CAA2C;AACrD,WAAO,QAAQ,OAAO,IAAI,MAAM,mCAAmC,CAAC;AAAA,EACxE;AACA,QAAM,cAAc,IAAI,OAAO,gBAAgB;AAC/C,aAAW,WAAW,OAAO;AACzB,QAAI,CAAC,QAAQ,SAAS,QAAQ,WAAW;AACrC,UAAI,KAAK,2EAA2E;AACpF,cAAQ,QAAQ,QAAQ;AAAA,IAC5B;AACA,QAAI,CAAC,QAAQ,SAAS,OAAO,QAAQ,SAAS,aAAa;AACvD,UAAI,KAAK,sEAAsE;AAC/E,cAAQ,QAAQ,QAAQ;AAAA,IAC5B;AACA,QAAI,CAAC,QAAQ,SAAS,CAAC,QAAQ,QAAQ,OAAO,QAAQ,UAAU,aAAa;AACzE,UAAI,MAAM,sEAAsE;AAChF,aAAO,QAAQ,OAAO,IAAI,MAAM,mCAAmC,CAAC;AAAA,IACxE;AACA,QAAI,CAAC,YAAY,KAAK,QAAQ,IAAI,GAAG;AACjC,UAAI,MAAM,wBAAwB,QAAQ,IAAI,gBAAgB;AAC9D,aAAO,QAAQ,OAAO,IAAI,MAAM,wBAAwB,QAAQ,IAAI,gBAAgB,CAAC;AAAA,IACzF;AAAA,EACJ;AACA,SAAO,YAAY,WAAW,OAAO,KAAK;AAC9C;AAUO,SAAS,eACZ,aACA,KACA,SACY;AACZ,QAAM,cAAmC,QAAQ;AACjD,MAAI,QAAQ,YAAY;AACxB,QAAM,OAAO,YAAY;AACzB,QAAM,QAAQ,YAAY;AAC1B,MAAI,CAAC,SAAS,YAAY,WAAW;AACjC,QAAI,KAAK,kEAAkE;AAC3E,YAAQ,YAAY;AAAA,EACxB;AACA,MAAI,CAAC,SAAS,CAAC,MAAM;AACjB,QAAI,MAAM,kDAAkD;AAC5D,WAAO,QAAQ,OAAO,IAAI,MAAM,iCAAiC,CAAC;AAAA,EACtE;AACA,QAAM,cAAc,IAAI,OAAO,gBAAgB;AAC/C,MAAI,CAAC,YAAY,KAAK,IAAI,GAAG;AACzB,QAAI,MAAM,wBAAwB,IAAI,gBAAgB;AACtD,WAAO,QAAQ,OAAO,IAAI,MAAM,wBAAwB,IAAI,gBAAgB,CAAC;AAAA,EACjF;AACA,SAAO,YAAY,SAAS,OAAO,MAAM,KAAK;AAClD;",
  "names": []
}

{
  "version": 3,
  "sources": ["../../src/lib/google.ts"],
  "sourcesContent": ["import { google } from 'googleapis';\nimport type { sheets_v4 } from 'googleapis/build/src/apis/sheets/v4';\n/**\n * This class provides utility functions to interact with Google Sheets\n *\n * @param config The adapter configuration\n * @param log The logger\n */\nexport class SpreadsheetUtils {\n    /**\n     * Constructor\n     *\n     * @param config The adapter configuration\n     * @param log The logger\n     */\n    public constructor(\n        private config: ioBroker.AdapterConfig,\n        private log: ioBroker.Log,\n    ) {}\n\n    /**\n     * Delete rows from a Google Spreadsheet\n     *\n     * @param sheetName Name of the sheet\n     * @param start First row to delete\n     * @param end Last row to delete\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public deleteRows(sheetName: string, start: number, end: number, sheetAlias: string | null = null): void {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n\n        sheets.spreadsheets\n            .get({ spreadsheetId })\n            .then(spreadsheet => {\n                if (spreadsheet && spreadsheet.data.sheets) {\n                    const sheet = spreadsheet.data.sheets.find(\n                        sheet => sheet.properties && sheet.properties.title == sheetName,\n                    );\n                    if (sheet && sheet.properties) {\n                        const sheetId = sheet.properties.sheetId;\n                        sheets.spreadsheets\n                            .batchUpdate({\n                                spreadsheetId,\n                                requestBody: {\n                                    requests: [\n                                        {\n                                            deleteDimension: {\n                                                range: {\n                                                    dimension: 'ROWS',\n                                                    endIndex: end,\n                                                    sheetId: sheetId,\n                                                    startIndex: start - 1,\n                                                },\n                                            },\n                                        },\n                                    ],\n                                },\n                            })\n                            .then(() => {\n                                this.log.debug('Rows successfully deleted from google spreadsheet');\n                            })\n                            .catch(error => {\n                                this.log.error(`Error while deleting rows from Google Spreadsheet:${error}`);\n                            });\n                    }\n                }\n            })\n            .catch(error => {\n                this.log.error(`Error while deleting rows from Google Spreadsheet:${error}`);\n            });\n    }\n\n    private init(): sheets_v4.Sheets {\n        const auth = new google.auth.GoogleAuth({\n            credentials: {\n                client_email: this.config.serviceAccountEmail,\n                private_key: this.formatPrivateKey(this.config.privateKey),\n            },\n            scopes: ['https://www.googleapis.com/auth/spreadsheets'],\n        });\n        return google.sheets({ version: 'v4', auth });\n    }\n\n    /**\n     * Create a new sheet in the Google Sheets\n     *\n     * @param title The title of the new sheet\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public createSheet(title: string, sheetAlias: string | null = null): void {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n\n        sheets.spreadsheets\n            .batchUpdate({\n                spreadsheetId,\n                requestBody: {\n                    requests: [\n                        {\n                            addSheet: {\n                                properties: {\n                                    title: title,\n                                },\n                            },\n                        },\n                    ],\n                },\n            })\n            .then(() => {\n                this.log.debug('Sheet created successfully');\n            })\n            .catch(error => {\n                this.log.error(`Error while creating sheet:${error}`);\n            });\n    }\n\n    /**\n     * Duplicate a sheet in the Google Spreadsheet\n     *\n     * @param source Name of the source sheet\n     * @param target Name of the target sheet\n     * @param index Position of the new sheet\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public duplicateSheet(source: string, target: string, index: number, sheetAlias: string | null = null): void {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n\n        sheets.spreadsheets\n            .get({ spreadsheetId })\n            .then(spreadsheet => {\n                if (spreadsheet && spreadsheet.data.sheets) {\n                    const sheet = spreadsheet.data.sheets.find(\n                        sheet => sheet.properties && sheet.properties.title == source,\n                    );\n                    if (sheet && sheet.properties) {\n                        let insertIndex = index;\n                        if (insertIndex == -1 || insertIndex == undefined) {\n                            insertIndex = spreadsheet.data.sheets.length;\n                        }\n                        sheets.spreadsheets\n                            .batchUpdate({\n                                spreadsheetId,\n                                requestBody: {\n                                    requests: [\n                                        {\n                                            duplicateSheet: {\n                                                sourceSheetId: sheet.properties.sheetId,\n                                                newSheetName: target,\n                                                insertSheetIndex: insertIndex,\n                                            },\n                                        },\n                                    ],\n                                },\n                            })\n                            .then(() => {\n                                this.log.debug('Data successfully sent to google spreadsheet');\n                            })\n                            .catch(error => {\n                                this.log.error(`Error while sending data to Google Spreadsheet:${error}`);\n                            });\n                    } else {\n                        this.log.warn(`Cannot find sheet: ${source}`);\n                    }\n                }\n            })\n            .catch(error => {\n                this.log.error(`Error while sending data to Google Spreadsheet:${error}`);\n            });\n    }\n\n    /**\n     * Upload a file to the Google Drive\n     *\n     * @param target Name of the target file\n     * @param parentFolder Name of the parent folder\n     * @param filecontent Data of the file\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public upload(target: string, parentFolder: string, filecontent: any): void {\n        const auth = new google.auth.GoogleAuth({\n            credentials: {\n                client_email: this.config.serviceAccountEmail,\n                private_key: this.formatPrivateKey(this.config.privateKey),\n            },\n            scopes: ['https://www.googleapis.com/auth/spreadsheets'],\n        });\n        const driveapi = google.drive({ version: 'v3', auth });\n        // Hinweis: sheetAlias wird hier nicht f\u00FCr die Drive API verwendet, da Drive keine spreadsheetId ben\u00F6tigt,\n        // aber falls du f\u00FCr verschiedene Konten/Freigaben arbeitest, ggf. anpassen.\n        driveapi.files\n            .create({\n                requestBody: {\n                    parents: [parentFolder],\n                    name: target,\n                },\n                media: {\n                    mimeType: 'application/octet-stream',\n                    body: filecontent,\n                },\n                fields: 'id',\n            })\n            .then(() => {\n                this.log.debug('Data successfully uploaded to google spreadsheet');\n            })\n            .catch(error => {\n                this.log.error(`Error while uploading data to Google Spreadsheet:${error}`);\n            });\n    }\n\n    /**\n     * Delete a sheet from the Google Spreadsheet\n     *\n     * @param title The title of the sheet to delete\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public deleteSheet(title: string, sheetAlias: string | null = null): void {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n\n        sheets.spreadsheets\n            .get({ spreadsheetId })\n            .then(spreadsheet => {\n                if (spreadsheet && spreadsheet.data.sheets) {\n                    const sheet = spreadsheet.data.sheets.find(\n                        sheet => sheet.properties && sheet.properties.title == title,\n                    );\n                    if (sheet && sheet.properties) {\n                        sheets.spreadsheets\n                            .batchUpdate({\n                                spreadsheetId,\n                                requestBody: {\n                                    requests: [\n                                        {\n                                            deleteSheet: {\n                                                sheetId: sheet.properties.sheetId,\n                                            },\n                                        },\n                                    ],\n                                },\n                            })\n                            .then(() => {\n                                this.log.debug('Data successfully sent to google spreadsheet');\n                            })\n                            .catch(error => {\n                                this.log.error(`Error while sending data to Google Spreadsheet:${error}`);\n                            });\n                    }\n                }\n            })\n            .catch(error => {\n                this.log.error(`Error while sending data to Google Spreadsheet:${error}`);\n            });\n    }\n\n    /**\n     * Delete multiple sheets from the Google Spreadsheet\n     *\n     * @param titles The titles of the sheets to delete\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public deleteSheets(titles: string[], sheetAlias: string | null = null): void {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n\n        sheets.spreadsheets\n            .get({ spreadsheetId })\n            .then(spreadsheet => {\n                if (spreadsheet && spreadsheet.data.sheets) {\n                    const requests: sheets_v4.Schema$Request[] = [];\n                    for (const title of titles) {\n                        const sheet = spreadsheet.data.sheets.find(\n                            sheet => sheet.properties && sheet.properties.title == title,\n                        );\n                        if (sheet && sheet.properties) {\n                            requests.push({\n                                deleteSheet: {\n                                    sheetId: sheet.properties.sheetId,\n                                },\n                            });\n                        }\n                    }\n                    if (requests.length > 0) {\n                        sheets.spreadsheets\n                            .batchUpdate({\n                                spreadsheetId,\n                                requestBody: {\n                                    requests: requests,\n                                },\n                            })\n                            .then(() => {\n                                this.log.debug('Sheets successfully deleted from google spreadsheet');\n                            })\n                            .catch(error => {\n                                this.log.error(`Error while deleting sheets from Google Spreadsheet:${error}`);\n                            });\n                    }\n                }\n            })\n            .catch(error => {\n                this.log.error(`Error while deleting sheets from Google Spreadsheet:${error}`);\n            });\n    }\n\n    /**\n     * Send data to a Google Spreadsheet\n     *\n     * @param sheetName Name of the sheet\n     * @param data Data to send\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public append(sheetName: string, data: any, sheetAlias: string | null = null): void {\n        const sheets = this.init();\n\n        sheets.spreadsheets.values\n            .append({\n                // The [A1 notation](/sheets/api/guides/concepts#cell) of a range to search for a logical table of data. Values are appended after the last row of the table.\n                range: sheetName,\n                spreadsheetId: this.getSpreadsheetId(sheetAlias),\n                valueInputOption: 'USER_ENTERED',\n                // Request body metadata\n                requestBody: {\n                    values: this.prepareValues(data),\n                },\n            })\n            .then(() => {\n                this.log.debug('Data successfully sent to google spreadsheet');\n            })\n            .catch(error => {\n                this.log.error(`Error while sending data to Google Spreadsheet:${error}`);\n            });\n    }\n\n    /**\n     * Get the spreadsheetId based on the alias or default\n     *\n     * @param sheetAlias Alias of the sheet to use (optional)\n     * @returns The spreadsheetId\n     */\n    getSpreadsheetId(sheetAlias: string | null): string {\n        if (sheetAlias) {\n            const sheet = this.config.spreadsheets.find(s => s.alias === sheetAlias);\n            if (sheet) {\n                return sheet.spreadsheetId;\n            }\n            this.log.warn(`No spreadsheet found for alias ${sheetAlias}, using default spreadsheetId`);\n        }\n        const defaultSheet = this.config.spreadsheets.find(s => s.isDefault);\n        if (defaultSheet) {\n            return defaultSheet.spreadsheetId;\n        }\n        throw new Error('No default spreadsheetId found in configuration');\n    }\n\n    /**\n     * Write data to a cell in a Google Spreadsheet\n     *\n     * @param sheetName Name of the sheet\n     * @param cell Cell to write to\n     * @param data Data to write\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public writeCell(sheetName: string, cell: string, data: any, sheetAlias: string | null = null): void {\n        this.writeCells([{ sheetName, cell, data }], sheetAlias);\n    }\n\n    /**\n     * Write multiple cells in a Google Spreadsheet\n     *\n     * @param cells Array of objects: { sheetName, cell, data }\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public writeCells(\n        cells: Array<{ sheetName: string; cell: string; data: any }>,\n        sheetAlias: string | null = null,\n    ): void {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n        // Gruppiere nach sheetName, da batchUpdate mehrere Bereiche pro Sheet erlaubt\n        const grouped: { [sheet: string]: Array<{ cell: string; data: any }> } = {};\n        for (const cellObj of cells) {\n            if (!grouped[cellObj.sheetName]) {\n                grouped[cellObj.sheetName] = [];\n            }\n            grouped[cellObj.sheetName].push({ cell: cellObj.cell, data: cellObj.data });\n        }\n        const data: Array<{ range: string; values: any[][] }> = [];\n        for (const sheetName in grouped) {\n            for (const entry of grouped[sheetName]) {\n                let cell = entry.cell;\n                if (cell.startsWith(\"'\") && cell.endsWith(\"'\")) {\n                    cell = cell.substring(1, cell.length - 1);\n                }\n                data.push({\n                    range: `${sheetName}!${cell}`,\n                    values: this.prepareValues(entry.data),\n                });\n            }\n        }\n        sheets.spreadsheets.values\n            .batchUpdate({\n                spreadsheetId,\n                requestBody: {\n                    valueInputOption: 'USER_ENTERED',\n                    data,\n                },\n            })\n            .then(() => {\n                this.log.debug('Cells successfully written to google spreadsheet');\n            })\n            .catch(error => {\n                this.log.error(`Error while writing cells to Google Spreadsheet:${error}`);\n            });\n    }\n\n    /**\n     * Read data from a cell in a Google Spreadsheet\n     *\n     * @param sheetName Name of the sheet\n     * @param cell Cell to read from\n     * @param sheetAlias Alias of the sheet to use (optional)\n     * @returns The data from the cell\n     */\n    public async readCell(sheetName: string, cell: string, sheetAlias: string | null = null): Promise<any> {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n        return new Promise<any>((resolve, reject) => {\n            if (cell.startsWith(\"'\") && cell.endsWith(\"'\")) {\n                cell = cell.substring(1, cell.length - 1);\n            }\n            sheets.spreadsheets.values\n                .get({\n                    range: `${sheetName}!${cell}`,\n                    spreadsheetId,\n                })\n                .then(response => {\n                    this.log.debug('Data successfully retrieved from google spreadsheet');\n                    if (response.data.values && response.data.values.length > 0) {\n                        resolve(response.data.values[0][0]);\n                    } else {\n                        reject(new Error('No data found'));\n                    }\n                })\n                .catch(error => {\n                    this.log.error(`Error while retrieving data from Google Spreadsheet:${error}`);\n                    reject(new Error(`Error while retrieving data from Google Spreadsheet: ${error.message}`));\n                });\n        });\n    }\n    private prepareValues(message: any): any {\n        if (Array.isArray(message)) {\n            return [message];\n        }\n        return [[message]];\n    }\n    private formatPrivateKey(privateKey: string): string | undefined {\n        //replace all \\n with line breaks\n        if (privateKey) {\n            return privateKey.replace(/\\\\n/g, '\\n');\n        }\n        return undefined;\n    }\n}\n"],
  "mappings": "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",
  "names": ["sheet"]
}

{
  "version": 3,
  "sources": ["../../src/lib/google.ts"],
  "sourcesContent": ["import { google } from 'googleapis';\nimport type { sheets_v4 } from 'googleapis/build/src/apis/sheets/v4';\n/**\n * This class provides utility functions to interact with Google Sheets\n *\n * @param config The adapter configuration\n * @param log The logger\n */\nexport class SpreadsheetUtils {\n    /**\n     * Constructor\n     *\n     * @param config The adapter configuration\n     * @param log The logger\n     */\n    public constructor(\n        private config: ioBroker.AdapterConfig,\n        private log: ioBroker.Log,\n    ) {}\n\n    private init(): sheets_v4.Sheets {\n        const auth = new google.auth.GoogleAuth({\n            credentials: {\n                client_email: this.config.serviceAccountEmail,\n                private_key: this.formatPrivateKey(this.config.privateKey),\n            },\n            scopes: ['https://www.googleapis.com/auth/spreadsheets'],\n        });\n        return google.sheets({ version: 'v4', auth });\n    }\n\n    /**\n     * Delete rows from a Google Spreadsheet\n     *\n     * @param sheetName Name of the sheet\n     * @param start First row to delete\n     * @param end Last row to delete\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public deleteRows(sheetName: string, start: number, end: number, sheetAlias: string | null = null): Promise<void> {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n        return new Promise<void>((resolve, reject) => {\n            sheets.spreadsheets\n                .get({ spreadsheetId })\n                .then(spreadsheet => {\n                    if (spreadsheet && spreadsheet.data.sheets) {\n                        const sheet = spreadsheet.data.sheets.find(\n                            sheet => sheet.properties && sheet.properties.title == sheetName,\n                        );\n                        if (sheet && sheet.properties) {\n                            const sheetId = sheet.properties.sheetId;\n                            sheets.spreadsheets\n                                .batchUpdate({\n                                    spreadsheetId,\n                                    requestBody: {\n                                        requests: [\n                                            {\n                                                deleteDimension: {\n                                                    range: {\n                                                        dimension: 'ROWS',\n                                                        endIndex: end,\n                                                        sheetId: sheetId,\n                                                        startIndex: start - 1,\n                                                    },\n                                                },\n                                            },\n                                        ],\n                                    },\n                                })\n                                .then(() => {\n                                    this.log.debug('Rows successfully deleted from google spreadsheet');\n                                    resolve();\n                                })\n                                .catch(error => {\n                                    this.log.error(`Error while deleting rows from Google Spreadsheet:${error}`);\n                                    reject(\n                                        new Error(\n                                            `Error while deleting rows from Google Spreadsheet: ${error.message}`,\n                                        ),\n                                    );\n                                });\n                        } else {\n                            reject(new Error('Sheet not found'));\n                        }\n                    } else {\n                        reject(new Error('No sheets found in spreadsheet'));\n                    }\n                })\n                .catch(error => {\n                    this.log.error(`Error while deleting rows from Google Spreadsheet:${error}`);\n                    reject(new Error(`Error while deleting rows from Google Spreadsheet: ${error.message}`));\n                });\n        });\n    }\n\n    /**\n     * Create a new sheet in the Google Sheets\n     *\n     * @param title The title of the new sheet\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public createSheet(title: string, sheetAlias: string | null = null): Promise<void> {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n        return new Promise<void>((resolve, reject) => {\n            sheets.spreadsheets\n                .batchUpdate({\n                    spreadsheetId,\n                    requestBody: {\n                        requests: [\n                            {\n                                addSheet: {\n                                    properties: {\n                                        title: title,\n                                    },\n                                },\n                            },\n                        ],\n                    },\n                })\n                .then(() => {\n                    this.log.debug('Sheet created successfully');\n                    resolve();\n                })\n                .catch(error => {\n                    reject(new Error(`Error while creating sheet: ${error.message}`));\n                });\n        });\n    }\n\n    /**\n     * Duplicate a sheet in the Google Spreadsheet\n     *\n     * @param source Name of the source sheet\n     * @param target Name of the target sheet\n     * @param index Position of the new sheet\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public duplicateSheet(\n        source: string,\n        target: string,\n        index: number,\n        sheetAlias: string | null = null,\n    ): Promise<void> {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n        return new Promise<void>((resolve, reject) => {\n            sheets.spreadsheets\n                .get({ spreadsheetId })\n                .then(spreadsheet => {\n                    if (spreadsheet && spreadsheet.data.sheets) {\n                        const sheet = spreadsheet.data.sheets.find(\n                            sheet => sheet.properties && sheet.properties.title == source,\n                        );\n                        if (sheet && sheet.properties) {\n                            let insertIndex = index;\n                            if (insertIndex == -1 || insertIndex == undefined) {\n                                insertIndex = spreadsheet.data.sheets.length;\n                            }\n                            sheets.spreadsheets\n                                .batchUpdate({\n                                    spreadsheetId,\n                                    requestBody: {\n                                        requests: [\n                                            {\n                                                duplicateSheet: {\n                                                    sourceSheetId: sheet.properties.sheetId,\n                                                    newSheetName: target,\n                                                    insertSheetIndex: insertIndex,\n                                                },\n                                            },\n                                        ],\n                                    },\n                                })\n                                .then(() => {\n                                    this.log.debug('Data successfully sent to google spreadsheet');\n                                    resolve();\n                                })\n                                .catch(error => {\n                                    this.log.error(`Error while sending data to Google Spreadsheet:${error}`);\n                                    reject(new Error(`Error while duplicating sheet: ${error.message}`));\n                                });\n                        } else {\n                            this.log.warn(`Cannot find sheet: ${source}`);\n                            reject(new Error(`Cannot find sheet: ${source}`));\n                        }\n                    } else {\n                        reject(new Error('No sheets found in spreadsheet'));\n                    }\n                })\n                .catch(error => {\n                    this.log.error(`Error while sending data to Google Spreadsheet:${error}`);\n                    reject(new Error(`Error while duplicating sheet: ${error.message}`));\n                });\n        });\n    }\n\n    /**\n     * Upload a file to the Google Drive\n     *\n     * @param target Name of the target file\n     * @param parentFolder Name of the parent folder\n     * @param filecontent Data of the file\n     */\n    public upload(target: string, parentFolder: string, filecontent: any): Promise<void> {\n        const auth = new google.auth.GoogleAuth({\n            credentials: {\n                client_email: this.config.serviceAccountEmail,\n                private_key: this.formatPrivateKey(this.config.privateKey),\n            },\n            scopes: ['https://www.googleapis.com/auth/spreadsheets'],\n        });\n        const driveapi = google.drive({ version: 'v3', auth });\n        return new Promise<void>((resolve, reject) => {\n            driveapi.files\n                .create({\n                    requestBody: {\n                        parents: [parentFolder],\n                        name: target,\n                    },\n                    media: {\n                        mimeType: 'application/octet-stream',\n                        body: filecontent,\n                    },\n                    fields: 'id',\n                })\n                .then(() => {\n                    this.log.debug('Data successfully uploaded to google spreadsheet');\n                    resolve();\n                })\n                .catch(error => {\n                    this.log.error(`Error while uploading data to Google Spreadsheet:${error}`);\n                    reject(new Error(`Error while uploading data to Google Spreadsheet: ${error.message}`));\n                });\n        });\n    }\n\n    /**\n     * Delete a sheet from the Google Spreadsheet\n     *\n     * @param title The title of the sheet to delete\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public deleteSheet(title: string, sheetAlias: string | null = null): Promise<void> {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n        return new Promise<void>((resolve, reject) => {\n            sheets.spreadsheets\n                .get({ spreadsheetId })\n                .then(spreadsheet => {\n                    if (spreadsheet && spreadsheet.data.sheets) {\n                        const sheet = spreadsheet.data.sheets.find(\n                            sheet => sheet.properties && sheet.properties.title == title,\n                        );\n                        if (sheet && sheet.properties) {\n                            sheets.spreadsheets\n                                .batchUpdate({\n                                    spreadsheetId,\n                                    requestBody: {\n                                        requests: [\n                                            {\n                                                deleteSheet: {\n                                                    sheetId: sheet.properties.sheetId,\n                                                },\n                                            },\n                                        ],\n                                    },\n                                })\n                                .then(() => {\n                                    this.log.debug('Data successfully sent to google spreadsheet');\n                                    resolve();\n                                })\n                                .catch(error => {\n                                    this.log.error(`Error while sending data to Google Spreadsheet:${error}`);\n                                    reject(new Error(`Error while deleting sheet: ${error.message}`));\n                                });\n                        } else {\n                            reject(new Error('Sheet not found'));\n                        }\n                    } else {\n                        reject(new Error('No sheets found in spreadsheet'));\n                    }\n                })\n                .catch(error => {\n                    this.log.error(`Error while sending data to Google Spreadsheet:${error}`);\n                    reject(new Error(`Error while deleting sheet: ${error.message}`));\n                });\n        });\n    }\n\n    /**\n     * Delete multiple sheets from the Google Spreadsheet\n     *\n     * @param titles The titles of the sheets to delete\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public deleteSheets(titles: string[], sheetAlias: string | null = null): Promise<void> {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n        return new Promise<void>((resolve, reject) => {\n            sheets.spreadsheets\n                .get({ spreadsheetId })\n                .then(spreadsheet => {\n                    if (spreadsheet && spreadsheet.data.sheets) {\n                        const requests: sheets_v4.Schema$Request[] = [];\n                        for (const title of titles) {\n                            const sheet = spreadsheet.data.sheets.find(\n                                sheet => sheet.properties && sheet.properties.title == title,\n                            );\n                            if (sheet && sheet.properties) {\n                                requests.push({\n                                    deleteSheet: {\n                                        sheetId: sheet.properties.sheetId,\n                                    },\n                                });\n                            }\n                        }\n                        if (requests.length > 0) {\n                            sheets.spreadsheets\n                                .batchUpdate({\n                                    spreadsheetId,\n                                    requestBody: {\n                                        requests: requests,\n                                    },\n                                })\n                                .then(() => {\n                                    this.log.debug('Sheets successfully deleted from google spreadsheet');\n                                    resolve();\n                                })\n                                .catch(error => {\n                                    this.log.error(`Error while deleting sheets from Google Spreadsheet:${error}`);\n                                    reject(new Error(`Error while deleting sheets: ${error.message}`));\n                                });\n                        } else {\n                            reject(new Error('No matching sheets found to delete'));\n                        }\n                    } else {\n                        reject(new Error('No sheets found in spreadsheet'));\n                    }\n                })\n                .catch(error => {\n                    this.log.error(`Error while deleting sheets from Google Spreadsheet:${error}`);\n                    reject(new Error(`Error while deleting sheets: ${error.message}`));\n                });\n        });\n    }\n\n    /**\n     * Send data to a Google Spreadsheet\n     *\n     * @param sheetName Name of the sheet\n     * @param data Data to send\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public append(sheetName: string, data: any, sheetAlias: string | null = null): Promise<void> {\n        const sheets = this.init();\n        return new Promise<void>((resolve, reject) => {\n            sheets.spreadsheets.values\n                .append({\n                    // The [A1 notation](/sheets/api/guides/concepts#cell) of a range to search for a logical table of data. Values are appended after the last row of the table.\n                    range: sheetName,\n                    spreadsheetId: this.getSpreadsheetId(sheetAlias),\n                    valueInputOption: 'USER_ENTERED',\n                    // Request body metadata\n                    requestBody: {\n                        values: this.prepareValues(data),\n                    },\n                })\n                .then(() => {\n                    this.log.debug('Data successfully sent to google spreadsheet');\n                    resolve();\n                })\n                .catch(error => {\n                    this.log.error(`Error while sending data to Google Spreadsheet:${error}`);\n                    reject(new Error(`Error while appending data: ${error.message}`));\n                });\n        });\n    }\n\n    /**\n     * Get the spreadsheetId based on the alias or default\n     *\n     * @param sheetAlias Alias of the sheet to use (optional)\n     * @returns The spreadsheetId\n     */\n    getSpreadsheetId(sheetAlias: string | null): string {\n        if (sheetAlias) {\n            const sheet = this.config.spreadsheets.find(s => s.alias === sheetAlias);\n            if (sheet) {\n                return sheet.spreadsheetId;\n            }\n            this.log.warn(`No spreadsheet found for alias ${sheetAlias}, using default spreadsheetId`);\n        }\n        const defaultSheet = this.config.spreadsheets.find(s => s.isDefault);\n        if (defaultSheet) {\n            return defaultSheet.spreadsheetId;\n        }\n        throw new Error('No default spreadsheetId found in configuration');\n    }\n\n    /**\n     * Write data to a cell in a Google Spreadsheet\n     *\n     * @param sheet Name of the sheet\n     * @param cell Cell to write to\n     * @param value Value to write\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public writeCell(sheet: string, cell: string, value: any, sheetAlias: string | null = null): Promise<void> {\n        return this.writeCells([{ sheet, cell, value }], sheetAlias);\n    }\n\n    /**\n     * Write multiple cells in a Google Spreadsheet\n     *\n     * @param cells Array of objects: { sheet, cell, value }\n     * @param sheetAlias Alias of the sheet to use (optional)\n     */\n    public writeCells(\n        cells: Array<{ sheet: string; cell: string; value: any }>,\n        sheetAlias: string | null = null,\n    ): Promise<void> {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n        this.log.info(`Writing cells to spreadsheetId: ${spreadsheetId}`);\n        // Gruppiere nach sheetName, da batchUpdate mehrere Bereiche pro Sheet erlaubt\n        const grouped: { [sheet: string]: Array<{ cell: string; data: any }> } = {};\n        for (const cellObj of cells) {\n            if (!grouped[cellObj.sheet]) {\n                grouped[cellObj.sheet] = [];\n            }\n            grouped[cellObj.sheet].push({ cell: cellObj.cell, data: cellObj.value });\n        }\n        const data: Array<{ range: string; values: any[][] }> = [];\n        for (const sheetName in grouped) {\n            for (const entry of grouped[sheetName]) {\n                let cell = entry.cell;\n                if (cell.startsWith(\"'\") && cell.endsWith(\"'\")) {\n                    cell = cell.substring(1, cell.length - 1);\n                }\n                data.push({\n                    range: `${sheetName}!${cell}`,\n                    values: this.prepareValues(entry.data),\n                });\n            }\n        }\n        this.log.debug(`Prepared data for writing: ${JSON.stringify(data)}`);\n        return new Promise<void>((resolve, reject) => {\n            sheets.spreadsheets.values\n                .batchUpdate({\n                    spreadsheetId,\n                    requestBody: {\n                        valueInputOption: 'USER_ENTERED',\n                        data,\n                    },\n                })\n                .then(() => {\n                    this.log.debug('Cells successfully written to google spreadsheet');\n                    resolve();\n                })\n                .catch(error => {\n                    this.log.error(`Error while writing cells to Google Spreadsheet:${error}`);\n                    reject(new Error(`Error while writing cells: ${error.message}`));\n                });\n        });\n    }\n\n    /**\n     * Read data from a cell in a Google Spreadsheet\n     *\n     * @param sheetName Name of the sheet\n     * @param cell Cell to read from\n     * @param sheetAlias Alias of the sheet to use (optional)\n     * @returns The data from the cell\n     */\n    public async readCell(sheetName: string, cell: string, sheetAlias: string | null = null): Promise<any> {\n        const sheets = this.init();\n        const spreadsheetId = this.getSpreadsheetId(sheetAlias);\n        return new Promise<any>((resolve, reject) => {\n            if (cell.startsWith(\"'\") && cell.endsWith(\"'\")) {\n                cell = cell.substring(1, cell.length - 1);\n            }\n            sheets.spreadsheets.values\n                .get({\n                    range: `${sheetName}!${cell}`,\n                    spreadsheetId,\n                })\n                .then(response => {\n                    this.log.debug('Data successfully retrieved from google spreadsheet');\n                    if (response.data.values && response.data.values.length > 0) {\n                        resolve(response.data.values[0][0]);\n                    } else {\n                        reject(new Error('No data found'));\n                    }\n                })\n                .catch(error => {\n                    this.log.error(`Error while retrieving data from Google Spreadsheet:${error}`);\n                    reject(new Error(`Error while retrieving data from Google Spreadsheet: ${error.message}`));\n                });\n        });\n    }\n    private prepareValues(message: any): any {\n        if (Array.isArray(message)) {\n            return [message];\n        }\n        return [[message]];\n    }\n    private formatPrivateKey(privateKey: string): string | undefined {\n        //replace all \\n with line breaks\n        if (privateKey) {\n            return privateKey.replace(/\\\\n/g, '\\n');\n        }\n        return undefined;\n    }\n}\n"],
  "mappings": "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",
  "names": ["sheet"]
}
